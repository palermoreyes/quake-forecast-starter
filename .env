# ============================================================
# ENTORNO GENERAL
# ============================================================

ENV=dev
PORT=8000

# ============================================================
# BASE DE DATOS (contenedor PostGIS local)
# ============================================================

DB_HOST=db
DB_PORT=5432
DB_NAME=quake
DB_USER=quake
DB_PASSWORD=changeme
DB_SSLMODE=disable

# URL de conexión SÍNCRONA para ETL / scheduler (psycopg2)
DATABASE_URL_SYNC=postgresql+psycopg2://quake:changeme@db:5432/quake

# URL de conexión ASÍNCRONA para FastAPI u otros scripts async (asyncpg)
DATABASE_URL_ASYNC=postgresql+asyncpg://quake:changeme@db:5432/quake

# VARIABLE PRINCIPAL (Corregida para usar asyncpg con la API)
DATABASE_URL=postgresql+asyncpg://quake:changeme@db:5432/quake


# ============================================================
# FUENTES IGP - CONFIGURACIÓN DE EXTRACCIÓN
# ============================================================

# Endpoint oficial de descarga (devuelve archivo XLSX mediante GET)
IGP_DOWNLOAD_URL=https://ultimosismo.igp.gob.pe/api/ultimo-sismo/descargar-datos

# Ruta local donde se guardará el archivo XLSX dentro del contenedor
IGP_HIST_LOCAL=/app/data/igp/landing/igp-datos-sismicos.xlsx

# ============================================================
# PARÁMETROS DE FILTRO
# ============================================================

IGP_CATALOGO=Instrumental
IGP_MAG_MIN=1
IGP_MAG_MAX=9
IGP_PROF_MIN=0
IGP_PROF_MAX=900
IGP_LAT_N=-1.396
IGP_LAT_S=-25.701
IGP_LON_E=-65.624
IGP_LON_W=-87.382

# ============================================================
# FECHAS Y RANGO DE DESCARGA
# ============================================================

# Zona horaria para el cálculo de la fecha actual
IGP_TZ=America/Lima

# Días hacia atrás a considerar desde la fecha actual.
# 24000 = descarga completa (desde 1960 aproximadamente)
# 3 = últimos 3 días (uso operativo diario)
IGP_LOOKBACK_DAYS=3

# ============================================================
# OPCIONES AVANZADAS
# ============================================================

# Si es TRUE, calcula la fecha de inicio usando el último evento registrado en la BD.
# Recomendado mantener en FALSE para desarrollos y pruebas.
IGP_FROM_DB_MAX=false

# Días adicionales de "colchón" al usar modo incremental (solo si FROM_DB_MAX=true)
IGP_FROM_DB_MAX_PADDING_DAYS=1

# ============================================================
# ENDPOINTS SECUNDARIOS (para pronósticos o datos recientes)
# ============================================================

# URL opcional para obtener datos recientes en formato GeoJSON (si se utiliza)
IGP_RECENT_URL=https://<URL_ARCGIS_IGP>?f=geojson
IGP_RECENT_LOOKBACK_DAYS=3

# ============================================================
# ENTRENAMIENTO DE MODELO E INFERENCIA
# ============================================================

# Utilizamos los ultimos 365 dias (o 90, según tu script forecast_predict.py)
INFER_LOOKBACK_DAYS=365
# Límite de celdas (se mantiene por compatibilidad aunque V2 ya no lo limite)
INFER_MAX_CELLS=2000

# ============================================================
# RUTAS DE LOS MODELOS
# ============================================================

MODELS_DIR=/app/artifacts/models